<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/app-route/app-location.html">

<link rel="import" href="../bower_components/font-roboto/font-roboto.html">

<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">

<link rel="import" href="../bower_components/paper-button/paper-button.html">

<link rel="import" href="xtrm-home.html">
<link rel="import" href="xtrm-button.html">
<link rel="import" href="xtrm-login-confirmation.html">
<link rel="import" href="xtrm-login-dialog.html">
<link rel="import" href="xtrm-location-info.html">

<dom-module id="xtrm-sports">
  <template>
    <style>
      :root {
        --primary-color: #FF0F03;
      }
      :host {
        position: relative;
        display: block;
        width: 100%;
        height: 100%;
        color: #fff;
      }
      iron-image {
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        filter: blur(3px);
        -webkit-filter: blur(3px);
      }
      iron-pages > * {
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
      }
      #login {
        position: absolute;
        top: 0;
        right: 0;
        z-index: 1;
      }
    </style>
    <iron-image id="backgroundImage" src="" sizing="cover"></iron-image>
    <app-location route="{{route}}"></app-location>
    <app-route
      route="{{route}}"
      pattern="/:page"
      data="{{data}}"
      tail="{{tail}}">
    </app-route>

    <xtrm-button id="login" on-tap="login">Login</xtrm-button>
    <iron-pages id="pageSelector" attr-for-selected="page" fallback-selection="home" selected="[[data.page]]" selected-item="{{pageSelected}}">
      <!-- each items needs a property "visible" which sets the background image -->
      <xtrm-home page="home"></xtrm-home>
      <xtrm-location-info page="location" route="[[tail]]"></xtrm-location-info>
      <xtrm-login-confirmation page="confirm" route="[[tail]]"></xtrm-login-confirmation>
    </iron-pages>
    <xtrm-login-dialog id="loginDialog"></xtrm-login-dialog>
  </template>
  <script>
    Polymer({
      is: 'xtrm-sports',

      properties: {
        pageSelected: {
          type: Object,
          observer: '_pageChanged'
        }
      },

      listeners: {
        'setPage': '_setPage',
        'setBackgroundImage': '_setBackgroundImage'
      },

      login: function() {
        this.$.loginDialog.open();
      },

      /*
      * _setPage(Event e)
      * set the main page to display
      *   e.detail.page: dom to show
      */
      _setPage: function(e){
        history.pushState(null, null, e.detail.page);
        switch(e.detail.page){
          case"location":
            break;
        }
      },

      /*
      * setBackgroundImage(Event e)
      * set the background image of the page
      *   e.detail.image: path to background image
      */
      _setBackgroundImage: function(e){
        this.$.backgroundImage.src = e.detail.image;
      },

      _pageChanged: function(){
        var item = this.$.pageSelector.selectedItem;
        console.warn("page changed");
        console.warn(item);
        console.warn(this.pageSelected);
        item.visible();
      }
    });
  </script>
</dom-module>